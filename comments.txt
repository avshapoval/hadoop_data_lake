Привет, доделал функционал и немного изменил код:
1. В расчете витрины в разрезе зон добавил расчет регистраций пользователей
2. Добавил расчет витрины рекомендаций
3. Немного изменил стрктуру кода дага - теперь все переменные объявляются один раз в коде, аргументы для спарк-приложений также задаются один раз в качестве дефолтных.

Жду ревью:)